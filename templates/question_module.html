<article>
    <div class="asker-info">
        <div class="info">
            <a href="/users/{{ str(asker["_id"]) }}">
                <img src="{{ asker["profile_pic_link"] }}">
            </a>
            <table>
                <tr>
                    <td>
                        <h2>
                            <a href="/users/{{ str(asker["_id"]) }}">{{ asker["username"] }}</a>
                        </h2>
                    </td>
                </tr>
                <tr>
                    <td>
                        <h3>
                            {% set total_seconds = (datetime.utcnow() - question["date"]).total_seconds() %}
                            {% if total_seconds < 30 %}
                                Just now
                            {% elif total_seconds < 60 %}
                                {{ int(total_seconds) }}s ago
                            {% elif total_seconds < 3600 %}
                                {{ int(total_seconds * 0.0166667) }}m ago
                            {% elif total_seconds < 86400 %}
                                {{ int(total_seconds * 0.000277778) }}h ago
                            {% elif total_seconds < 172800 %}
                                Yesterday
                            {% elif total_seconds < 15770000 %}
                                {{ question["date"].strftime("%B %d") }}
                            {% else %}
                                {{ question["date"].strftime("%B %d, %Y") }}
                            {% end %}
                        </h3>
                    </td>
                </tr>
            </table>
        </div>
        <div class="vote-count">
            <h4>
                {% set vote_count = sum([q["votes"] for q in question["data"]]) %}
                {% if vote_count <= 1000 %}
                    {{ vote_count }}
                {% elif vote_count <= 999999 %}
                    {{ round(vote_count/1000, 1) }}K
                {% else %}
                    {{ round(vote_count/1000000, 1) }}M
                {% end %}
                Votes
            </h4>
        </div>
    </div>
    <div class="question-image" style="background-image: url({{ question["image_link"] }})"></div>
    <div class="chart">
        <h1 class="question"><a href="{{ "/questions/" + str(question["_id"]) }}">{{ question["question"] }}</a></h1>
        <div class="labels {{ str(question["_id"]) }}">
            {% for idx, q in enumerate(question["data"]) %}
                {% if vote == None %}
                    <h4><div class="label-box"></div>{{ q["label"] }}</h4>
                {% else %}
                    {% if int(idx) == int(vote) %}
                        <h4 class="active"><div class="label-box"></div>{{ q["label"] }}</h4>
                    {% else %}
                        <h4><div class="label-box"></div>{{ q["label"] }}</h4>
                    {% end %}
                {% end %}
            {% end %}
        </div>
        <canvas>
            <div class="chart-data">{{ json.dumps(question["data"]) }}</div>
        </canvas>
        <div class="chart-footer">
            <h4 class="favorite-count">
                {% set favorites = question["favorites"] %}
                {% if favorites <= 1000 %}
                    {{ favorites }}
                {% elif favorites <= 999999 %}
                    {{ round(favorites/1000, 1) }}K
                {% else %}
                    {{ round(favorites/1000000, 1) }}M
                {% end %}
                <div title="Add to Favorites" class="svg-image {{ str(question["_id"]) }}">
                    {% if favorited %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Heart" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M17.19 4.155c-1.672-1.534-4.383-1.534-6.055 0L10 5.197 8.864 4.155c-1.672-1.534-4.382-1.534-6.054 0-1.881 1.727-1.881 4.52 0 6.246L10 17l7.19-6.599C19.07 8.675 19.07 5.881 17.19 4.155z" fill="#693CA1"/>
                        </svg>
                    {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Heart" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M17.19 4.155c-1.672-1.534-4.383-1.534-6.055 0L10 5.197 8.864 4.155c-1.672-1.534-4.382-1.534-6.054 0-1.881 1.727-1.881 4.52 0 6.246L10 17l7.19-6.599C19.07 8.675 19.07 5.881 17.19 4.155z" fill="#8d8d8d"/>
                        </svg>
                    {% end %}
                </div>
            </h4>
            <h4 class="share-count">
                {% set shares = question["shares"] %}
                {% if shares <= 1000 %}
                    {{ shares }}
                {% elif shares <= 999999 %}
                    {{ round(shares/1000, 1) }}K
                {% else %}
                    {{ round(shares/1000000, 1) }}M
                {% end %}
                <div title="Share" class="svg-image {{ str(question["_id"]) }}">
                    {% if shared %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Forward" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M12 11.874v4.357l7-6.69-7-6.572v3.983c-8.775 0-11 9.732-11 9.732C3.484 12.296 7.237 11.874 12 11.874z" fill="#693ca1"/>
                        </svg>
                    {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Forward" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M12 11.874v4.357l7-6.69-7-6.572v3.983c-8.775 0-11 9.732-11 9.732C3.484 12.296 7.237 11.874 12 11.874z" fill="#8d8d8d"/>
                        </svg>
                    {% end %}
                </div>
            </h4>
            <h4 class="comment-count">
                <div class="comment-count-text">
                    {% set comments = len(question["comments"]) %}
                    {% if comments <= 1000 %}
                        {{ comments }}
                    {% elif comments <= 999999 %}
                        {{ round(comments/1000, 1) }}K
                    {% else %}
                        {{ round(comments/1000000, 1) }}M
                    {% end %}
                </div>
                <a href="/questions/{{ str(question["_id"]) }}#comments"><div title="See Comments" class="svg-image">
                    {% if commented %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Chat" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M5.8 12.2V6H2C0.9 6 0 6.9 0 8v6c0 1.1 0.9 2 2 2h1v3l3-3h5c1.1 0 2-0.9 2-2v-1.82c-0.064 0.014-0.132 0.021-0.2 0.021h-7V12.2zM18 1H9C7.9 1 7 1.9 7 3v8h7l3 3v-3h1c1.1 0 2-0.899 2-2V3C20 1.9 19.1 1 18 1z" fill="#693ca1"/>
                        </svg>
                    {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Chat" x="0px" y="0px" viewBox="0 0 20 20" xml:space="preserve" enable-background="new 0 0 20 20">
                            <path d="M5.8 12.2V6H2C0.9 6 0 6.9 0 8v6c0 1.1 0.9 2 2 2h1v3l3-3h5c1.1 0 2-0.9 2-2v-1.82c-0.064 0.014-0.132 0.021-0.2 0.021h-7V12.2zM18 1H9C7.9 1 7 1.9 7 3v8h7l3 3v-3h1c1.1 0 2-0.899 2-2V3C20 1.9 19.1 1 18 1z" fill="#8d8d8d"/>
                        </svg>
                    {% end %}
                </div></a>
            </h4>
        </div>
        {% if show_comments %}
            {% module Comment(question, users) %}
        {% end %}
    </div>
</article>